<source>
  @type http
  port 8888
  bind 0.0.0.0
</source>

<match site-configuration>
  @type rewrite_tag_filter
  <rule>
    key title
    pattern ldm-streaming
    tag ldm-streaming
  </rule>
  <rule>
    key title
    pattern event-timeline
    tag event-timeline
  </rule>
</match>

<match ldm-streaming>
  @type file
  path /fluentd/log/site-configuration/ldm-streaming
  append true
  compress gzip
  # @type http
  # endpoint /ldm-streaming
  # open_timeout 5s
  # read_timeout 5s

  <buffer>
    @type file
    path /fluentd/log/site-configuration/ldm-streaming
    timekey 1d
    timekey_wait 10m
    timekey_use_utc true
    flush_mode interval
    flush_interval 30s
    retry_forever true
  </buffer>
</match>

<match event-timeline>
  @type file
  path /fluentd/log/site-configuration/event-timeline
  append true
  compress gzip
  # @type http
  # endpoint /event-timeline
  # open_timeout 5s
  # read_timeout 5s

  <buffer>
    @type file
    path /fluentd/log/site-configuration/event-timeline
    timekey 1d
    timekey_wait 10m
    timekey_use_utc true
    flush_mode interval
    flush_interval 30s
    retry_forever true
  </buffer>
</match>